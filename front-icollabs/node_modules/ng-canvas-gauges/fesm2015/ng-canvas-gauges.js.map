{"version":3,"file":"ng-canvas-gauges.js.map","sources":["ng://ng-canvas-gauges/lib/base-gauge.ts","ng://ng-canvas-gauges/lib/linear-gauge.ts","ng://ng-canvas-gauges/lib/radial-gauge.ts","ng://ng-canvas-gauges/lib/gauges.module.ts"],"sourcesContent":["/*!\n * The MIT License (MIT)\n *\n * Copyright (c) 2017 Vlad Martynenko <vladimir.martynenko.work@gmail.com>\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\nimport { ViewChild, Input, NgZone, ElementRef, OnInit, AfterViewInit } from '@angular/core';\nimport * as CanvasGauges from 'canvas-gauges';\nimport * as Rx from 'rx-dom-html';\n\n\n\n// String utils\nconst toCamelCase = (str: string) => str.replace(/(\\-\\w)/g, (matches) => matches[1].toUpperCase());\n\nconst toKebabCase = (str: string) => str.replace(/([a-z0-9])([A-Z])/g, '$1-$2').toLowerCase();\n\nconst attributeName2PropertyName = (attrName: string) => toCamelCase(attrName);\n\n\n\n\n/**\n * Base gauge component for the Gauges rendering\n * T - Type of the Gauge to be rendered (Currently RadialGauge, LinearGauge from the original library)\n * T2 - Type of config options used by the particular gauge (RadialGaugeOptions, LinearGaugeOptions)\n */\nexport abstract class BaseGauge<T extends CanvasGauges.BaseGauge, T2 extends CanvasGauges.GenericOptions>\n    implements OnInit, AfterViewInit {\n\n    /**\n     * Canvas element on the template used by the library to draw gauge element\n     */\n    @ViewChild('gauge')\n    protected canvas: ElementRef;\n\n    /**\n     * A gauge instance responsible for rendering and updates on the canvas.\n     * Subclasses should initialize in their ngOnInit implementation.\n     */\n    protected gauge: T;\n\n\n    /**\n     * Flag indicating that OnViewInit life-cycle has completed\n     */\n    private isInited = false;\n\n    /**\n     * value property of gauge prior to component view initialization\n     */\n    private preInitValue: number;\n\n    /**\n     * options property of gauge prior to component view initialization\n     */\n    private preInitOptions: T2;\n\n\n    /**\n     * Listen for attribute changes, i.e., options properties that are stored\n     * as attributes on this ElementRef\n     */\n    private domListener: MutationObserver;\n\n\n    /**\n     *\n     * @param el - reference to the element of the whole component, used to scrape options declared on the component itself\n     * @param zone - required to redraw gauge outside of Angular, due to animation lags caused by the ovewritten function of the ngZone\n     */\n    constructor(private el: ElementRef, public zone: NgZone) {\n    }\n\n\n    /**\n     * Subclasses should instantiate the CanvasGauge object in the child component\n     */\n    abstract ngOnInit(): void;\n\n\n    /**\n     * Returns gauges properties as an options object.\n     * Option properties consist of the attribute-based properties and those\n     * explicitly set.\n     * @returns <T2>\n     */\n    public get options(): T2 {\n\n        const options = {} as T2;\n        options.renderTo = this.canvas.nativeElement;\n\n        // Map attribute-based options onto options.\n        // Requries converting kebab style attribute names to camelCase property names\n        for (const attr of this.el.nativeElement.attributes) {\n            const prop = attributeName2PropertyName(attr.name);\n            options[prop] = CanvasGauges.DomObserver.parse(attr.value);\n        }\n\n        // merge preOptons with attribute-based properties\n        // tslint:disable-next-line:forin\n        for (const prop in this.preInitOptions) {\n            options[prop] = this.preInitOptions[prop];\n        }\n\n        // clear the preInitOptions as they have already been merged\n        // with the attribute-based properties\n        if (this.isInited) {\n            this.preInitOptions = null;\n        }\n\n        return options;\n    }\n\n\n    /**\n     * Assign gauge options at anytime in the lifecycle.\n     * @param newOptions - assign the style and size properties\n     */\n    @Input()\n    public set options(newOptions: T2) {\n\n        // cache newOptions as preInitOptions until gauge is ready\n        if (!this.isInited) {\n            this.preInitOptions = newOptions;\n            return;\n        }\n\n        this.update(newOptions);\n    }\n\n\n    /**\n     * Assign the value of the gauge visual indicator such as a needle or pointer\n     * @param newValue  the guage new value\n     */\n    @Input()\n    public set value(newValue: number) {\n\n        // case new gauge value as preInitValue until the gauge is ready\n        if (!this.isInited) {\n            this.preInitValue = newValue;\n            return;\n        }\n\n        this.zone.runOutsideAngular(() => {\n            this.gauge.value = newValue;\n        });\n    }\n\n\n    /**\n     * Update the gauge options. Do not use until after OnViewInit() before using.\n     *\n     * Special implementation note - options.properties are maintained as\n     * attribute name->value on this component's elementRef.  Thus this method\n     * maps each newOptions property onto the property's corresponding attribute.\n     * The attribute update triggers a DOM mutation event which  \"this\" listens for.\n     * See #listenForDOMEvents()\n     *\n     * @param newOptions  - the options to update the gauge\n     */\n    public update(newOptions: T2 | {}) {\n\n        // map all options onto this element's attributes\n        // Then attribute changes will be detected and pushed to the gauge.update()\n        if (!newOptions) { return; }\n\n        // tslint:disable-next-line:forin\n        for (const prop in newOptions) {\n            const val = newOptions[prop].toString();\n\n            if (prop === 'value') {\n                // short circuit the value property update by calling\n                // the gauge.value api directly for efficient animated update\n                this.value = CanvasGauges.DomObserver.parse(val);\n            } else {\n                const attrName = toKebabCase(prop);\n                this.el.nativeElement.setAttribute(attrName, val);\n            }\n        }\n    }\n\n\n    /**\n     * Perform gauge initialization.\n     * Subclasses that override this method must this super version\n     * for proper operation.\n     */\n    public ngAfterViewInit() {\n\n        // initial update of gauge properties\n        this.initGauge();\n\n        this.listenForDOMEvents();\n\n        this.isInited = true;\n    }\n\n\n    /**\n     * Listen for attribute-change events that are created when updating\n     * the options of this gauge.\n     */\n    protected listenForDOMEvents() {\n        // Listen to gauge element for attribute changes\n        // Convert all changed attribtues into a GenericOptions or subclass\n        // Update the gauge with the new options.\n        this.domListener =\n            Rx.DOM.fromMutationObserver(this.el.nativeElement, { attributes: true }).\n                subscribe(changes => {\n                    const newOptions = {} as T2;\n                    changes.forEach(change => {\n                        if ('attributes' === change.type) {\n                            // console.log('DOM, change', change.attributeName);\n                            newOptions[attributeName2PropertyName(change.attributeName)] =\n                                CanvasGauges.DomObserver.parse(\n                                    this.el.nativeElement.getAttribute(change.attributeName));\n                        }\n                    });\n\n                    this.basicUpdate(newOptions);\n                });\n    }\n\n\n    /**\n     * Discontinue listening for attribute change events.\n     */\n    protected stopListeningForDOMEvents() {\n        if (this.domListener) {\n            this.domListener.disconnect();\n            this.domListener = null;\n        }\n    }\n\n\n    /**\n     * Initalize the gauge with all options defined by attributes and\n     * parent component options.\n     */\n    protected initGauge() {\n        const options = this.options;\n        if (this.preInitValue) {\n            options.value = this.preInitValue;\n        }\n\n        // init options.renderTo if needed\n        if (!options.hasOwnProperty('renderTo') || !options.renderTo) {\n            options.renderTo = this.canvas.nativeElement;\n        }\n\n        this.basicUpdate(options);\n    }\n\n\n    /**\n     * Performs the gauge update using the current options\n     * @param options  The options for the guage\n     */\n    protected basicUpdate(options: T2) {\n\n        // treat the value property special and update it through the\n        // value getter.\n        if (typeof options.value === 'number') {\n\n            // use gauge api directly for most efficient update method\n            this.value = options.value;\n\n            // filter value property from options to avoid redundant\n            // processing by gauge\n            delete options.value;\n        }\n\n        // do nothing if no option properties to update\n        if (Object.keys(options).length) {\n            this.gauge.update(options);\n        }\n    }\n\n}\n\n\n\n","/*!\n * The MIT License (MIT)\n *\n * Copyright (c) 2017 Vlad Martynenko <vladimir.martynenko.work@gmail.com>\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\nimport {Component, NgZone, ElementRef, OnInit} from '@angular/core';\nimport {BaseGauge} from './base-gauge';\nimport * as CanvasGauges from 'canvas-gauges';\n\nexport { LinearGaugeOptions } from 'canvas-gauges';\n\n/**\n * Implements Linear Gauge from the original library\n */\n@Component({\n    // tslint:disable-next-line:component-selector\n    selector: 'linear-gauge',\n    template: '<canvas #gauge></canvas>'\n})\n// tslint:disable-next-line:component-class-suffix\nexport class LinearGauge extends BaseGauge<CanvasGauges.LinearGauge, CanvasGauges.LinearGaugeOptions> implements OnInit {\n\n    constructor(el: ElementRef, zone: NgZone) {\n        super(el, zone);\n    }\n\n\n    ngOnInit(): void {\n        this.gauge = new CanvasGauges.LinearGauge(this.options).draw();\n    }\n}\n","/*!\n * The MIT License (MIT)\n *\n * Copyright (c) 2017 Vlad Martynenko <vladimir.martynenko.work@gmail.com>\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\nimport { Component, NgZone, ElementRef, OnInit } from '@angular/core';\nimport { BaseGauge } from './base-gauge';\nimport * as CanvasGauges from 'canvas-gauges';\n\nexport { RadialGaugeOptions } from 'canvas-gauges';\n\n/**\n * Implements Radial Gauge from the original library\n */\n@Component({\n    // tslint:disable-next-line:component-selector\n    selector: 'radial-gauge',\n    template: '<canvas #gauge></canvas>'\n})\n// tslint:disable-next-line:component-class-suffix\nexport class RadialGauge extends BaseGauge<CanvasGauges.RadialGauge, CanvasGauges.RadialGaugeOptions> implements OnInit {\n    constructor(el: ElementRef, zone: NgZone) {\n        super(el, zone);\n    }\n\n    ngOnInit() {\n        this.gauge = new CanvasGauges.RadialGauge(this.options).draw();\n    }\n}\n","import { NgModule } from '@angular/core';\nimport { LinearGauge } from './linear-gauge';\nimport { RadialGauge } from './radial-gauge';\n\n@NgModule({\n  declarations: [\n    LinearGauge,\n    RadialGauge],\n  imports: [\n  ],\n  exports: [\n    LinearGauge,\n    RadialGauge]\n})\nexport class GaugesModule { }\n"],"names":["CanvasGauges.DomObserver","Rx.DOM","LinearGauge","CanvasGauges.LinearGauge","RadialGauge","CanvasGauges.RadialGauge"],"mappings":"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"}
